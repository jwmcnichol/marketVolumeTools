import pandas as pd
import requests
from datetime import datetime

regions_dict = {
    10000019: "A821-A",
    12000001: "ADR01",
    12000002: "ADR02",
    12000003: "ADR03",
    12000004: "ADR04",
    12000005: "ADR05",
    11000001: "A-R00001",
    11000002: "A-R00002",
    11000003: "A-R00003",
    10000054: "Aridia",
    10000069: "Black Rise",
    11000004: "B-R00004",
    11000005: "B-R00005",
    11000006: "B-R00006",
    11000007: "B-R00007",
    11000008: "B-R00008",
    10000055: "Branch",
    10000007: "Cache",
    10000014: "Catch",
    10000051: "Cloud Ring",
    10000053: "Cobalt Edge",
    11000009: "C-R00009",
    11000010: "C-R00010",
    11000011: "C-R00011",
    11000012: "C-R00012",
    11000013: "C-R00013",
    11000014: "C-R00014",
    11000015: "C-R00015",
    10000012: "Curse",
    10000035: "Deklein",
    10000060: "Delve",
    10000001: "Derelik",
    10000005: "Detorid",
    10000036: "Devoid",
    10000043: "Domain",
    11000016: "D-R00016",
    11000017: "D-R00017",
    11000018: "D-R00018",
    11000019: "D-R00019",
    11000020: "D-R00020",
    11000021: "D-R00021",
    11000022: "D-R00022",
    11000023: "D-R00023",
    11000024: "E-R00024",
    11000025: "E-R00025",
    11000026: "E-R00026",
    11000027: "E-R00027",
    11000028: "E-R00028",
    11000029: "E-R00029",
    10000039: "Esoteria",
    10000064: "Essence",
    10000027: "Etherium Reach",
    10000037: "Everyshore",
    10000046: "Fade",
    10000056: "Feythabolis",
    10000058: "Fountain",
    11000030: "F-R00030",
    10000029: "Geminate",
    10000067: "Genesis",
    11000031: "G-R00031",
    10000011: "Great Wildlands",
    10000030: "Heimatar",
    11000032: "H-R00032",
    10000025: "Immensea",
    10000031: "Impass",
    10000009: "Insmother",
    10000017: "J7HZ-F",
    10000052: "Kador",
    10000049: "Khanid",
    10000065: "Kor-Azor",
    11000033: "K-R00033",
    10000016: "Lonetrek",
    10000013: "Malpais",
    10000042: "Metropolis",
    10000028: "Molden Heath",
    13000001: "No Name",
    10000040: "Oasa",
    10000062: "Omist",
    10000021: "Outer Passage",
    10000057: "Outer Ring",
    10000059: "Paragon Soul",
    10000063: "Period Basis",
    10000066: "Perrigen Falls",
    10000048: "Placid",
    10000070: "Pochven",
    10000047: "Providence",
    10000023: "Pure Blind",
    10000050: "Querious",
    10000008: "Scalding Pass",
    10000032: "Sinq Laison",
    10000044: "Solitude",
    10000022: "Stain",
    10000041: "Syndicate",
    10000020: "Tash-Murkon",
    10000045: "Tenal",
    10000061: "Tenerifis",
    10000038: "The Bleak Lands",
    10000033: "The Citadel",
    10000002: "The Forge",
    10000034: "The Kalevala Expanse",
    10000018: "The Spire",
    10000010: "Tribute",
    10000004: "UUA-F4",
    10000003: "Vale of the Silent",
    10000015: "Venal",
    10000068: "Verge Vendor",
    14000001: "VR-01",
    14000002: "VR-02",
    14000003: "VR-03",
    14000004: "VR-04",
    14000005: "VR-05",
    10000006: "Wicked Creek",
    10001000: "Yasna Zakh"

}

selected_regions = {
    10000002: "The Forge",
    10000043: "Domain",
    10000064: "Essence",
    10000030: "Heimatar",
    10000032: "Sinq Laison",
    10000042: "Metropolis",
}

# all_factions_packed = [
#    all_fac_items_500,
#    all_fac_items_1000,
#    all_fac_items_1182,
#    domination
# ]

types_list = [615,
              617,
              2178,
              2180,
              2182,
              2188,
              2834,
              2836,
              2838,
              2948,
              3218,
              3514,
              3516,
              3518,
              3532,
              3534,
              3536,
              3542,
              3544,
              3546,
              3550,
              3559,
              3561,
              3563,
              3565,
              3571,
              3573,
              3575,
              4005,
              4363,
              4388,
              11011,
              11936,
              11938,
              11940,
              11942,
              13202,
              13773,
              13774,
              13775,
              13776,
              13777,
              13778,
              13779,
              13781,
              13782,
              13783,
              13784,
              13785,
              13786,
              13787,
              13788,
              13791,
              13793,
              13795,
              13797,
              13799,
              13801,
              13803,
              13805,
              13807,
              13809,
              13811,
              13813,
              13815,
              13817,
              13819,
              13820,
              13821,
              13822,
              13823,
              13824,
              13825,
              13826,
              13827,
              13828,
              13829,
              13830,
              13831,
              13832,
              13833,
              13834,
              13864,
              13865,
              13866,
              13867,
              13868,
              13870,
              13872,
              13873,
              13874,
              13876,
              13878,
              13879,
              13880,
              13881,
              13882,
              13883,
              13884,
              13885,
              13886,
              13887,
              13888,
              13889,
              13890,
              13891,
              13892,
              13893,
              13894,
              13919,
              13920,
              13921,
              13922,
              13923,
              13924,
              13925,
              13926,
              13927,
              13929,
              13931,
              13933,
              13935,
              13937,
              13939,
              13941,
              13943,
              13945,
              13947,
              13948,
              13949,
              13950,
              13951,
              13952,
              13953,
              13954,
              13955,
              13956,
              13957,
              13958,
              13959,
              13960,
              13962,
              13963,
              13964,
              13965,
              13966,
              13967,
              13968,
              13969,
              13970,
              13972,
              13974,
              13976,
              13978,
              13980,
              13982,
              13984,
              13986,
              13988,
              13990,
              13992,
              13994,
              13995,
              13996,
              13997,
              13998,
              13999,
              14001,
              14003,
              14005,
              14007,
              14009,
              14011,
              14013,
              14015,
              14017,
              14019,
              14021,
              14023,
              14025,
              14027,
              14029,
              14031,
              14033,
              14035,
              14037,
              14039,
              14041,
              14043,
              14045,
              14047,
              14049,
              14051,
              14053,
              14055,
              14057,
              14059,
              14061,
              14063,
              14065,
              14067,
              14068,
              14069,
              14070,
              14072,
              14074,
              14076,
              14078,
              14080,
              14082,
              14084,
              14086,
              14088,
              14090,
              14092,
              14094,
              14096,
              14098,
              14100,
              14102,
              14104,
              14106,
              14108,
              14110,
              14112,
              14114,
              14116,
              14118,
              14120,
              14122,
              14124,
              14126,
              14127,
              14128,
              14130,
              14132,
              14134,
              14136,
              14138,
              14140,
              14142,
              14144,
              14146,
              14148,
              14150,
              14152,
              14154,
              14156,
              14158,
              14160,
              14162,
              14164,
              14166,
              14168,
              14170,
              14172,
              14174,
              14176,
              14178,
              14180,
              14182,
              14184,
              14186,
              14188,
              14190,
              14192,
              14194,
              14196,
              14198,
              14200,
              14202,
              14204,
              14206,
              14208,
              14210,
              14212,
              14214,
              14218,
              14220,
              14222,
              14224,
              14226,
              14228,
              14230,
              14232,
              14234,
              14236,
              14238,
              14240,
              14242,
              14244,
              14246,
              14248,
              14250,
              14252,
              14254,
              14256,
              14258,
              14260,
              14262,
              14264,
              14266,
              14268,
              14270,
              15675,
              15677,
              15681,
              15683,
              15685,
              15687,
              15689,
              15691,
              15693,
              15695,
              15697,
              15699,
              15701,
              15703,
              15705,
              15707,
              15709,
              15711,
              15713,
              15715,
              15717,
              15719,
              15721,
              15723,
              15725,
              15727,
              15729,
              15731,
              15733,
              15735,
              15737,
              15739,
              15741,
              15742,
              15743,
              15744,
              15745,
              15746,
              15747,
              15749,
              15751,
              15753,
              15755,
              15757,
              15759,
              15761,
              15764,
              15766,
              15768,
              15770,
              15772,
              15774,
              15776,
              15778,
              15780,
              15782,
              15784,
              15786,
              15788,
              15790,
              15792,
              15794,
              15796,
              15798,
              15800,
              15802,
              15804,
              15806,
              15808,
              15810,
              15812,
              15813,
              15814,
              15815,
              15816,
              15817,
              15818,
              15820,
              15821,
              15823,
              15824,
              15825,
              15826,
              15827,
              15828,
              15829,
              15830,
              15831,
              15832,
              15833,
              15834,
              15835,
              15836,
              15837,
              15838,
              15840,
              15841,
              15843,
              15844,
              15845,
              15846,
              15847,
              15848,
              15849,
              15850,
              15851,
              15852,
              15853,
              15854,
              15855,
              15856,
              15857,
              15858,
              15859,
              15860,
              15861,
              15862,
              15863,
              15864,
              15865,
              15866,
              15867,
              15868,
              15869,
              15870,
              15871,
              15872,
              15873,
              15874,
              15875,
              15877,
              15879,
              15881,
              15883,
              15885,
              15887,
              15889,
              15891,
              15893,
              15895,
              15897,
              15898,
              15899,
              15900,
              15901,
              15902,
              15903,
              15904,
              15905,
              15907,
              15909,
              15911,
              15913,
              15915,
              15917,
              15919,
              15921,
              15923,
              15925,
              15927,
              15929,
              15931,
              15933,
              15935,
              15937,
              15939,
              15941,
              15943,
              15945,
              15947,
              15949,
              15951,
              15953,
              15955,
              15957,
              15959,
              15961,
              15963,
              15965,
              15967,
              16046,
              16047,
              16048,
              16049,
              16050,
              16051,
              16052,
              16053,
              16054,
              16055,
              16056,
              16057,
              16058,
              16059,
              16060,
              16061,
              16062,
              16064,
              16065,
              16067,
              16068,
              16126,
              17484,
              17485,
              17487,
              17488,
              17490,
              17491,
              17492,
              17493,
              17494,
              17495,
              17496,
              17497,
              17498,
              17499,
              17500,
              17502,
              17504,
              17506,
              17508,
              17510,
              17512,
              17514,
              17516,
              17518,
              17520,
              17522,
              17524,
              17526,
              17528,
              17536,
              17538,
              17540,
              17542,
              17544,
              17546,
              17547,
              17548,
              17549,
              17551,
              17553,
              17555,
              17557,
              17559,
              17619,
              17634,
              17636,
              17703,
              17709,
              17713,
              17715,
              17718,
              17720,
              17722,
              17726,
              17728,
              17732,
              17736,
              17738,
              17740,
              17812,
              17832,
              17834,
              17836,
              17838,
              17841,
              17843,
              17918,
              17920,
              17922,
              17924,
              17926,
              17928,
              17930,
              17932,
              19491,
              19534,
              19535,
              19536,
              19537,
              19538,
              19539,
              19540,
              19551,
              19553,
              19554,
              19555,
              19556,
              19962,
              19964,
              19966,
              19968,
              19970,
              19972,
              19974,
              19976,
              19978,
              19980,
              19982,
              19984,
              19986,
              19988,
              19990,
              19992,
              19994,
              19996,
              19998,
              20000,
              20002,
              20004,
              20006,
              20008,
              20010,
              20012,
              20014,
              20016,
              20018,
              20020,
              20022,
              20024,
              20026,
              20028,
              20030,
              20032,
              20034,
              20036,
              20038,
              20040,
              20043,
              20045,
              20047,
              20049,
              20051,
              20053,
              20055,
              20057,
              20121,
              20157,
              20158,
              20159,
              20160,
              20161,
              20199,
              20498,
              20499,
              20500,
              20501,
              20502,
              20503,
              20504,
              20505,
              20506,
              20507,
              20508,
              20509,
              20721,
              20723,
              20725,
              20727,
              20729,
              20731,
              20733,
              20735,
              20737,
              20739,
              20741,
              20743,
              20745,
              20747,
              20749,
              20751,
              20753,
              20755,
              20757,
              20759,
              20761,
              20763,
              20765,
              20767,
              20769,
              20771,
              20773,
              20775,
              20777,
              20779,
              20781,
              20783,
              20785,
              20787,
              20789,
              20791,
              20793,
              20795,
              20797,
              20799,
              20801,
              20803,
              20805,
              20807,
              20809,
              20811,
              20813,
              20815,
              20817,
              20819,
              20821,
              20823,
              20825,
              20827,
              20829,
              20831,
              20833,
              20835,
              20837,
              20839,
              20841,
              20843,
              20845,
              20847,
              20849,
              20851,
              20853,
              20855,
              20857,
              20859,
              20861,
              20863,
              20865,
              20867,
              20869,
              20871,
              20873,
              20875,
              20877,
              20879,
              20881,
              20883,
              20885,
              20887,
              20889,
              20891,
              20893,
              20895,
              20897,
              20899,
              20901,
              20903,
              20905,
              20907,
              20909,
              20911,
              20913,
              20915,
              20917,
              20919,
              20921,
              20923,
              20925,
              20927,
              20929,
              20931,
              20933,
              20935,
              20937,
              20939,
              20941,
              20943,
              20945,
              20947,
              20949,
              20951,
              20953,
              20955,
              20957,
              20959,
              20961,
              20963,
              20965,
              20967,
              20969,
              20971,
              20973,
              20975,
              20977,
              20979,
              20981,
              20983,
              20985,
              20987,
              20989,
              20991,
              20993,
              20995,
              20997,
              20999,
              21001,
              21003,
              21005,
              21007,
              21194,
              21196,
              21198,
              21200,
              21202,
              21204,
              21206,
              21208,
              21210,
              21212,
              21214,
              21216,
              21218,
              21220,
              21222,
              21224,
              21226,
              21228,
              21230,
              21232,
              21234,
              21236,
              21238,
              21240,
              21242,
              21244,
              21246,
              21248,
              21250,
              21252,
              21254,
              21256,
              21258,
              21260,
              21262,
              21264,
              21266,
              21268,
              21270,
              21272,
              21274,
              21276,
              21278,
              21280,
              21282,
              21284,
              21286,
              21288,
              21290,
              21292,
              21294,
              21296,
              21298,
              21300,
              21302,
              21304,
              21306,
              21308,
              21310,
              21312,
              21314,
              21316,
              21318,
              21320,
              21322,
              21324,
              21326,
              21328,
              21330,
              21332,
              21334,
              21336,
              21338,
              21340,
              21342,
              21344,
              21346,
              21348,
              21350,
              21352,
              21354,
              21356,
              21358,
              21360,
              21362,
              21364,
              21366,
              21368,
              21370,
              21372,
              21374,
              21376,
              21378,
              21380,
              21382,
              21384,
              21386,
              21388,
              21390,
              21392,
              21394,
              21396,
              21398,
              21400,
              21402,
              21404,
              21406,
              21408,
              21410,
              21412,
              21414,
              21416,
              21418,
              21420,
              21422,
              21424,
              21426,
              21428,
              21430,
              21432,
              21434,
              21436,
              21438,
              21440,
              21442,
              21444,
              21446,
              21450,
              21628,
              21740,
              21894,
              21896,
              21898,
              21900,
              21902,
              21904,
              21906,
              21908,
              21910,
              21912,
              21914,
              21916,
              21918,
              21920,
              21922,
              21924,
              21926,
              21928,
              21931,
              21933,
              21935,
              21937,
              21939,
              21941,
              22107,
              22108,
              22109,
              22110,
              22111,
              22112,
              22113,
              22114,
              22115,
              22116,
              22117,
              22118,
              22119,
              22120,
              22121,
              22122,
              22123,
              22124,
              22125,
              22126,
              22127,
              22128,
              22129,
              22130,
              22131,
              22133,
              22134,
              22135,
              22136,
              22137,
              22564,
              22565,
              22566,
              22567,
              22568,
              22569,
              22961,
              22963,
              22965,
              22967,
              22969,
              22971,
              22973,
              22975,
              22977,
              22979,
              22981,
              22983,
              22985,
              22987,
              22989,
              22991,
              22993,
              22995,
              22997,
              22999,
              23001,
              23003,
              23005,
              23007,
              23009,
              23011,
              23013,
              23015,
              23017,
              23019,
              23021,
              23023,
              23025,
              23027,
              23029,
              23031,
              23033,
              23035,
              23037,
              23039,
              23041,
              23043,
              23045,
              23047,
              23049,
              23051,
              23053,
              23071,
              23073,
              23075,
              23077,
              23079,
              23081,
              23083,
              23085,
              23089,
              23091,
              23093,
              23095,
              23097,
              23099,
              23101,
              23103,
              23105,
              23107,
              23109,
              23111,
              23113,
              23115,
              23117,
              23119,
              26840,
              26842,
              27313,
              27315,
              27317,
              27319,
              27321,
              27323,
              27325,
              27327,
              27329,
              27331,
              27333,
              27335,
              27337,
              27339,
              27341,
              27343,
              27345,
              27347,
              27349,
              27351,
              27353,
              27355,
              27357,
              27359,
              27361,
              27363,
              27365,
              27367,
              27369,
              27371,
              27373,
              27375,
              27377,
              27379,
              27381,
              27383,
              27385,
              27387,
              27389,
              27391,
              27393,
              27395,
              27397,
              27399,
              27401,
              27403,
              27405,
              27407,
              27409,
              27411,
              27413,
              27415,
              27417,
              27419,
              27421,
              27423,
              27425,
              27427,
              27429,
              27431,
              27433,
              27435,
              27437,
              27439,
              27441,
              27443,
              27445,
              27447,
              27449,
              27451,
              27453,
              27455,
              27457,
              27459,
              27461,
              27463,
              27465,
              27467,
              27469,
              27471,
              27473,
              27475,
              27477,
              27479,
              27481,
              27483,
              27485,
              27487,
              27489,
              27491,
              27493,
              27495,
              27497,
              27499,
              27501,
              27503,
              27505,
              27507,
              27509,
              27511,
              27513,
              27515,
              27517,
              27519,
              27521,
              27523,
              27525,
              27527,
              27530,
              27532,
              27533,
              27535,
              27536,
              27538,
              27539,
              27540,
              27542,
              27544,
              27545,
              27547,
              27548,
              27550,
              27551,
              27553,
              27554,
              27556,
              27557,
              27559,
              27560,
              27562,
              27563,
              27565,
              27567,
              27569,
              27570,
              27573,
              27574,
              27576,
              27577,
              27579,
              27580,
              27582,
              27583,
              27585,
              27589,
              27591,
              27592,
              27594,
              27595,
              27597,
              27598,
              27600,
              27601,
              27603,
              27604,
              27606,
              27607,
              27609,
              27610,
              27612,
              27613,
              27615,
              27616,
              27618,
              27619,
              27621,
              27622,
              27624,
              27625,
              27627,
              27628,
              27630,
              27631,
              27633,
              27634,
              27636,
              27638,
              27640,
              27641,
              27643,
              27644,
              27646,
              27647,
              27649,
              27650,
              27652,
              27653,
              27655,
              27766,
              27767,
              27768,
              27769,
              27770,
              27771,
              27772,
              27773,
              27774,
              27775,
              27776,
              27777,
              27778,
              27779,
              27780,
              27782,
              27784,
              27786,
              27788,
              27790,
              27855,
              27856,
              27857,
              27858,
              28262,
              28264,
              28266,
              28268,
              28270,
              28272,
              28274,
              28276,
              28278,
              28280,
              28282,
              28284,
              28286,
              28288,
              28290,
              28292,
              28294,
              28296,
              28298,
              28300,
              28302,
              28304,
              28306,
              28308,
              28324,
              28326,
              28328,
              28330,
              28332,
              28334,
              28336,
              28338,
              28375,
              28377,
              28379,
              28381,
              28383,
              28511,
              28514,
              28516,
              28518,
              28520,
              28522,
              28524,
              28526,
              28528,
              28530,
              28532,
              28534,
              28536,
              28538,
              28540,
              28542,
              28544,
              28545,
              28547,
              28549,
              28550,
              28552,
              28554,
              28556,
              28557,
              28559,
              28561,
              28563,
              28565,
              28729,
              28731,
              28733,
              28735,
              28737,
              28739,
              28740,
              28742,
              28744,
              28746,
              28748,
              28750,
              28752,
              28754,
              28756,
              28758,
              28766,
              28768,
              28770,
              28772,
              28774,
              28776,
              28778,
              28780,
              28782,
              28784,
              28786,
              28788,
              28790,
              28791,
              28792,
              28793,
              28794,
              28795,
              28796,
              28797,
              28798,
              28799,
              28800,
              28801,
              28802,
              28803,
              28804,
              28805,
              28806,
              28807,
              28808,
              28809,
              28810,
              28811,
              28812,
              28813,
              28814,
              28815,
              28816,
              28817,
              28818,
              28819,
              29336,
              29337,
              29340,
              29344,
              29616,
              29618,
              29620,
              29622,
              30486,
              30488,
              31864,
              31866,
              31868,
              31870,
              31872,
              31874,
              31876,
              31878,
              31880,
              31882,
              31884,
              31886,
              31888,
              31890,
              31892,
              31894,
              31896,
              31898,
              31900,
              31902,
              31904,
              31906,
              31908,
              31910,
              31916,
              31918,
              31922,
              31924,
              31926,
              31928,
              31930,
              31932,
              31936,
              31942,
              31944,
              31946,
              31948,
              31950,
              31952,
              31954,
              31955,
              31956,
              31957,
              31958,
              31959,
              31962,
              31963,
              31964,
              31965,
              31966,
              31967,
              31968,
              31969,
              31970,
              31971,
              31972,
              31973,
              31974,
              31975,
              31976,
              31977,
              31978,
              31979,
              31982,
              31990,
              31998,
              32006,
              32014,
              32101,
              32102,
              32103,
              32104,
              32105,
              32107,
              32108,
              32109,
              32110,
              32111,
              32112,
              32113,
              32114,
              32115,
              32116,
              32117,
              32118,
              32119,
              32120,
              32121,
              32122,
              32123,
              32124,
              32125,
              32207,
              32209,
              32305,
              32307,
              32309,
              32311,
              32413,
              32414,
              32416,
              32417,
              32788,
              32790,
              32809,
              32811,
              32840,
              32842,
              32844,
              32846,
              32848,
              32983,
              32985,
              32987,
              32989,
              33079,
              33081,
              33083,
              33099,
              33151,
              33153,
              33155,
              33157,
              33190,
              33328,
              33330,
              33332,
              33334,
              33395,
              33397,
              33403,
              33404,
              33405,
              33406,
              33446,
              33452,
              33453,
              33459,
              33464,
              33468,
              33470,
              33472,
              33516,
              33525,
              33526,
              33527,
              33528,
              33529,
              33553,
              33555,
              33557,
              33559,
              33561,
              33563,
              33565,
              33677,
              33681,
              33816,
              33818,
              33820,
              33826,
              33828,
              33830,
              33832,
              33842,
              33844,
              33846,
              33848,
              33850,
              33852,
              33867,
              33917,
              33918,
              33919,
              33920,
              33921,
              33922,
              33923,
              33924,
              33925,
              33926,
              33927,
              33928,
              33929,
              33930,
              33931,
              33932,
              33933,
              33934,
              33935,
              33936,
              33937,
              33938,
              33939,
              33940,
              33941,
              33942,
              33943,
              33944,
              33945,
              33946,
              33947,
              33948,
              33949,
              33950,
              33951,
              33952,
              33953,
              33954,
              33955,
              33956,
              33957,
              33958,
              33959,
              33960,
              33961,
              33962,
              33963,
              33964,
              33965,
              33966,
              33967,
              33968,
              33969,
              33970,
              33971,
              33972,
              33973,
              33974,
              33975,
              33976,
              34151,
              34271,
              34461,
              34462,
              34463,
              34464,
              34475,
              34476,
              34481,
              34483,
              34485,
              34487,
              34489,
              34496,
              34590,
              35779,
              35781,
              37293,
              37452,
              37453,
              37454,
              37455,
              37456,
              37612,
              37613,
              37805,
              37820,
              37825,
              40340,
              40663,
              40664,
              40669,
              40670,
              40690,
              40718,
              40736,
              40737,
              40762,
              40764,
              41030,
              41038,
              41058,
              41059,
              41061,
              41062,
              41066,
              41067,
              41079,
              41083,
              41103,
              41104,
              41118,
              41119,
              41130,
              41142,
              41154,
              41160,
              41174,
              41182,
              41191,
              41196,
              41197,
              41198,
              41199,
              41200,
              41201,
              41202,
              41212,
              41213,
              41214,
              41215,
              41216,
              41217,
              41218,
              41219,
              41220,
              41240,
              41241,
              41254,
              41255,
              41417,
              41456,
              41457,
              41458,
              41459,
              41460,
              41461,
              41462,
              41467,
              41468,
              41472,
              41473,
              41474,
              41487,
              41488,
              41490,
              41494,
              41495,
              41501,
              41502,
              41508,
              41509,
              41510,
              41526,
              41527,
              41529,
              41530,
              41531,
              42124,
              42125,
              42126,
              42132,
              42133,
              42145,
              42146,
              42200,
              42201,
              42202,
              42203,
              42204,
              42205,
              42206,
              42207,
              42208,
              42209,
              42210,
              42211,
              42212,
              42213,
              42214,
              42215,
              42241,
              42242,
              42243,
              42245,
              42246,
              43681,
              43694,
              43695,
              43696,
              43697,
              43698,
              43701,
              43775,
              45530,
              45531,
              45645,
              45647,
              45649,
              47258,
              47447,
              47448,
              47512,
              47513,
              47514,
              47515,
              47516,
              47915,
              47919,
              47923,
              49774,
              52244,
              52674,
              52679,
              52680,
              52681,
              52682,
              52683,
              52785,
              52786,
              52787,
              52788,
              52789,
              52790,
              52917,
              52918,
              52919,
              52920,
              52921,
              52922,
              52929,
              52930,
              52931,
              52938,
              52939,
              52940,
              52952,
              52953,
              52954,
              52961,
              52962,
              52963,
              53704,
              53705,
              53706,
              53707,
              53708,
              53709,
              53710,
              53711,
              53712,
              53713,
              53714,
              53715,
              53839,
              53853,
              53854,
              53855,
              53856,
              53857,
              53890,
              53891,
              53892,
              53893,
              53894,
              53895,
              53896,
              53897,
              53898,
              53899,
              53900,
              53901,
              53902,
              53903,
              53904,
              53905,
              53906,
              53907,
              54006,
              54007,
              54008,
              54015,
              54016,
              54017,
              54024,
              54025,
              54026,
              54033,
              54034,
              54035,
              54042,
              54043,
              54044,
              54051,
              54052,
              54053,
              54060,
              54061,
              54062,
              54069,
              54070,
              54071,
              54078,
              54079,
              54080,
              54087,
              54088,
              54089,
              54096,
              54097,
              54098,
              54105,
              54106,
              54107,
              54392,
              54393,
              54394,
              54395,
              54396,
              54397,
              54398,
              54399,
              54400,
              54401,
              54402,
              54403,
              54404,
              54405,
              54406,
              54407,
              54408,
              54409,
              54743,
              54749,
              54754,
              55761,
              57110,
              57111,
              57112,
              57113,
              57114,
              57116,
              57117,
              57118,
              57119,
              57120,
              57121,
              57122,
              57123,
              57124,
              57125,
              57126,
              57127,
              57128,
              60315,
              60764,
              60765,
              60766,
              64024,
              64025,
              64026,
              64027,
              72811,
              72812,
              72869,
              72872,
              72903,
              72904,
              72907,
              72913,
              73787,
              73789,
              73790,
              73792,
              73793,
              73794,
              73795,
              73796,
              74141,
              74316

              ]

ita_dict = {10000002: "The Forge"}
jita = {10000002: 'JITA'}
trit = [34, 35]
polarized_weapons = [5723,
                     5747,
                     5759,
                     34272,
                     34273,
                     34274,
                     34275,
                     34276,
                     34277,
                     34278,
                     34279,
                     34280,
                     34281,
                     34282,
                     34283,
                     34284,
                     34285,
                     34286,
                     34287,
                     34288,
                     34289,
                     34290,
                     34291,
                     34292,
                     34293,
                     34294,
                     34295
                     ]


def ensure_list(value):
    if not isinstance(value, list):
        return [value]
    return value


def split_list(input_list, segment_size):
    if segment_size <= 0:
        raise ValueError("must be positive.")
    output = [input_list[i:i + segment_size] for i in range(0, len(input_list), segment_size)]
    print(output)
    return output


faction_types = split_list(types_list, 499)
trit_types = split_list(trit, 499)
polarized_types = split_list(polarized_weapons, 499)


def get_multiple_market_histories(type_ids, region_id):
    counter = 0
    print(type_ids, region_id)
    print("warning selected regions list may be corrupt, double check dict entries")
    histories = {}
    # ensure_list(type_ids)
    # print(type_ids, "is list")
    for type_id in type_ids:
        counter = counter + 1
        print(type_id, region_id, counter, "of", len(type_ids))
        try:
            histories[type_id] = get_market_history(type_id, region_id)
        except requests.HTTPError as e:
            print(f"Failed to fetch data for type ID {type_id}: {e}")
    return histories


def get_market_history(type_id, region_id=10000002):
    url = f"https://esi.evetech.net/latest/markets/{region_id}/history/?type_id={type_id}"
    response = requests.get(url)
    response.raise_for_status()  # Raise an exception for HTTP errors
    return response.json()


def process_market_data(histories, region):
    all_data = []
    for type_id, history in histories.items():
        for entry in history:
            entry['type_id'] = type_id
            all_data.append(entry)
    df = pd.DataFrame(all_data)
    df['Region'] = region
    # write_csv(df)
    return df


def write_csv(df):
    df.to_csv('output.csv', index=False)
    return


# def start_multiple(data):
#     start_time = datetime.now()
#     counter = 0
#     master_df = pd.DataFrame()
#     for region in regions_list:
#         region_history = get_multiple_market_histories(data, region)
#         loop_df = process_market_data(region_history, region)
#         master_df = pd.concat([master_df, loop_df], ignore_index=True)
#         print(loop_df.head())
#         print('Completed', region)
#         counter = counter + 1
#         end_time = datetime.now()
#         print(end_time - start_time)
#     master_df.to_csv('output.csv', index=False)


def start_selected(regions_group, decompose_reference_list):
    selected_regions_list = []
    for key, value in regions_group.items():
        print(key, "selected")
        selected_regions_list.append(key)
    start_time = datetime.now()
    counter = 0
    master_df = pd.DataFrame()
    for region in selected_regions_list:
        for type_list in decompose_reference_list:
            region_history = get_multiple_market_histories(type_list, region)
            loop_df = process_market_data(region_history, region)
            master_df = pd.concat([master_df, loop_df], ignore_index=True)
            print(loop_df.head())
            print('Completed', region)
            counter = counter + 1
            print(counter, "of", len(selected_regions_list))
            end_time = datetime.now()
            print(end_time - start_time)
    master_df.to_csv('output.csv', index=False)


# Example usage:
# input_list = [12345, 67890, 23456, 78901, 34567, 89012, 45678, 90123]
# chunk_size = 3
# result = split_list(input_list, chunk_size)
# print(result)
# start_multiple(faction_ship_ids)

start_selected(jita, polarized_types)
